<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Help Center — Ratemetro.com</title>
<script>
  (function(){var t=localStorage.getItem('ratemetro-theme')||'dark';document.documentElement.setAttribute('data-theme',t);})();
</script>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg-dark: #0d0d18;
    --surface: rgba(20, 20, 35, 0.88);
    --surface-light: rgba(28, 28, 48, 0.82);
    --accent: #f5c518;
    --accent-glow: rgba(245, 197, 24, 0.3);
    --danger: #ff3b30;
    --success: #30d158;
    --text-primary: #f0f0f5;
    --text-secondary: rgba(255, 255, 255, 0.55);
    --text-muted: rgba(255, 255, 255, 0.3);
    --border: rgba(255, 255, 255, 0.07);
  }

  [data-theme="light"] {
    --bg-dark: #f2f2f7;
    --surface: rgba(255, 255, 255, 0.95);
    --surface-light: rgba(240, 240, 245, 0.9);
    --accent: #d4a017;
    --accent-glow: rgba(212, 160, 23, 0.2);
    --danger: #ff3b30;
    --success: #30d158;
    --text-primary: #1c1c1e;
    --text-secondary: rgba(0, 0, 0, 0.55);
    --text-muted: rgba(0, 0, 0, 0.35);
    --border: rgba(0, 0, 0, 0.1);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--bg-dark);
    color: var(--text-primary);
    min-height: 100vh;
    -webkit-font-smoothing: antialiased;
    overflow-x: hidden;
  }

  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      linear-gradient(rgba(245,197,24,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(245,197,24,0.03) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events: none;
    z-index: 0;
  }
  [data-theme="light"] body::before {
    background-image:
      linear-gradient(rgba(0,0,0,0.04) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0,0,0,0.04) 1px, transparent 1px);
  }

  /* ── Nav ── */
  .nav {
    position: fixed;
    top: 0; left: 0; right: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    background: rgba(10,10,15,0.88);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border);
    animation: slideDown 0.4s ease both;
  }
  [data-theme="light"] .nav {
    background: rgba(242,242,247,0.92);
    border-bottom-color: rgba(0,0,0,0.08);
  }
  [data-theme="light"] .nav-back { background: rgba(0,0,0,0.05); border-color: rgba(0,0,0,0.1); }
  [data-theme="light"] .nav-back svg { stroke: rgba(0,0,0,0.5); }
  [data-theme="light"] .nav-back:hover { border-color: var(--accent); background: rgba(0,0,0,0.08); }
  [data-theme="light"] .nav-back:hover svg { stroke: var(--accent); }
  .nav-back {
    width: 40px; height: 40px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
    flex-shrink: 0;
    text-decoration: none;
  }
  .nav-back:hover { border-color: var(--accent); box-shadow: 0 0 12px var(--accent-glow); }
  .nav-back svg { width: 16px; height: 16px; stroke: var(--text-secondary); fill: none; stroke-width: 2.5; stroke-linecap: round; stroke-linejoin: round; }
  .nav-back:hover svg { stroke: var(--accent); }
  .nav-title { font-size: 15px; font-weight: 700; color: var(--text-primary); }

  /* ── Page ── */
  .page {
    padding-top: 72px;
    padding-bottom: 48px;
    max-width: 560px;
    margin: 0 auto;
    position: relative;
    z-index: 1;
  }

  /* ── Hero ── */
  .hero {
    padding: 28px 16px 20px;
    text-align: center;
    animation: slideDown 0.5s ease 0.05s both;
  }
  .hero-icon {
    width: 56px; height: 56px;
    background: rgba(245,197,24,0.1);
    border: 1px solid rgba(245,197,24,0.22);
    border-radius: 18px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 14px;
    box-shadow: 0 0 24px rgba(245,197,24,0.12);
  }
  .hero-icon svg { width: 26px; height: 26px; stroke: var(--accent); fill: none; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
  .hero-title {
    font-size: 22px;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 6px;
    letter-spacing: -0.3px;
  }
  .hero-sub {
    font-size: 13px;
    color: var(--text-secondary);
    line-height: 1.5;
    max-width: 300px;
    margin: 0 auto;
  }

  /* ── Search Bar ── */
  .search-wrap {
    padding: 4px 16px 8px;
    animation: slideDown 0.5s ease 0.1s both;
  }
  .search-inner {
    position: relative;
    display: flex;
    align-items: center;
  }
  .search-icon {
    position: absolute;
    left: 14px;
    z-index: 1;
    width: 15px; height: 15px;
    stroke: var(--text-secondary);
    fill: none;
    stroke-width: 2;
    stroke-linecap: round;
    stroke-linejoin: round;
    pointer-events: none;
  }
  .search-input {
    width: 100%;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 11px 40px 11px 40px;
    color: var(--text-primary);
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    outline: none;
    transition: all 0.2s ease;
    caret-color: var(--accent);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
  }
  .search-input::placeholder { color: var(--text-muted); }
  .search-input:focus { border-color: rgba(245,197,24,0.35); box-shadow: 0 0 0 3px rgba(245,197,24,0.07); }
  [data-theme="light"] .search-input:focus { box-shadow: 0 0 0 3px rgba(212,160,23,0.1); }
  .search-clear {
    position: absolute;
    right: 12px;
    width: 20px; height: 20px;
    background: rgba(255,255,255,0.1);
    border: none;
    border-radius: 50%;
    color: var(--text-muted);
    font-size: 12px;
    cursor: pointer;
    display: none;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    line-height: 1;
  }
  [data-theme="light"] .search-clear { background: rgba(0,0,0,0.08); }
  .search-clear.visible { display: flex; }
  .search-clear:hover { background: rgba(255,255,255,0.18); color: var(--text-primary); }
  [data-theme="light"] .search-clear:hover { background: rgba(0,0,0,0.14); }

  /* ── Section ── */
  .section {
    margin: 12px 16px 0;
    animation: slideUp 0.5s ease both;
  }
  .section:nth-child(1) { animation-delay: 0.15s; }
  .section:nth-child(2) { animation-delay: 0.20s; }
  .section:nth-child(3) { animation-delay: 0.25s; }
  .section:nth-child(4) { animation-delay: 0.30s; }
  .section:nth-child(5) { animation-delay: 0.35s; }
  .section:nth-child(6) { animation-delay: 0.40s; }

  .section-label {
    font-size: 11px;
    font-weight: 700;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 1px;
    padding: 0 4px;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .section-label svg {
    width: 12px; height: 12px;
    stroke: var(--text-muted);
    fill: none;
    stroke-width: 2;
    stroke-linecap: round;
    stroke-linejoin: round;
    flex-shrink: 0;
  }

  .section-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    overflow: hidden;
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
  }

  /* ── FAQ Accordion ── */
  .faq-item {
    border-bottom: 1px solid var(--border);
    overflow: hidden;
  }
  .faq-item:last-child { border-bottom: none; }

  .faq-question {
    width: 100%;
    background: none;
    border: none;
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 14px 16px;
    cursor: pointer;
    text-align: left;
    transition: background 0.15s ease;
    min-height: 52px;
  }
  .faq-question:hover { background: rgba(255,255,255,0.035); }
  .faq-question:active { background: rgba(255,255,255,0.06); }
  [data-theme="light"] .faq-question:hover { background: rgba(0,0,0,0.025); }
  [data-theme="light"] .faq-question:active { background: rgba(0,0,0,0.05); }

  .faq-question-text {
    flex: 1;
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    line-height: 1.35;
  }

  .faq-chevron {
    width: 16px; height: 16px;
    stroke: var(--text-muted);
    fill: none;
    stroke-width: 2.5;
    stroke-linecap: round;
    stroke-linejoin: round;
    flex-shrink: 0;
    transition: transform 0.25s cubic-bezier(0.4,0,0.2,1), stroke 0.2s;
  }
  .faq-item.open .faq-chevron {
    transform: rotate(180deg);
    stroke: var(--accent);
  }

  .faq-answer-wrap {
    overflow: hidden;
    max-height: 0;
    transition: max-height 0.3s cubic-bezier(0.4,0,0.2,1);
  }
  .faq-item.open .faq-answer-wrap {
    max-height: 400px;
  }

  .faq-answer {
    padding: 0 16px 16px 16px;
    font-size: 13px;
    color: var(--text-secondary);
    line-height: 1.6;
    border-top: 1px solid var(--border);
    padding-top: 12px;
  }

  /* ── No results ── */
  .no-results {
    margin: 12px 16px 0;
    padding: 40px 16px;
    text-align: center;
    color: var(--text-muted);
    font-size: 14px;
    display: none;
    animation: fadeIn 0.2s ease both;
  }
  .no-results.visible { display: block; }
  .no-results-icon {
    font-size: 32px;
    display: block;
    margin-bottom: 10px;
    opacity: 0.5;
  }

  /* ── Contact Card ── */
  .contact-section {
    margin: 16px 16px 0;
    animation: slideUp 0.5s ease 0.45s both;
  }
  .contact-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 24px 20px;
    text-align: center;
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    position: relative;
    overflow: hidden;
  }
  .contact-card::before {
    content: '';
    position: absolute;
    top: 0; left: 50%;
    transform: translateX(-50%);
    width: 60%;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--accent-glow), transparent);
  }
  .contact-icon {
    width: 44px; height: 44px;
    background: rgba(245,197,24,0.08);
    border: 1px solid rgba(245,197,24,0.15);
    border-radius: 14px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 12px;
  }
  .contact-icon svg { width: 22px; height: 22px; stroke: var(--accent); fill: none; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
  .contact-title {
    font-size: 16px;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 4px;
  }
  .contact-sub {
    font-size: 13px;
    color: var(--text-secondary);
    margin-bottom: 18px;
    line-height: 1.4;
  }
  .contact-btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: var(--accent);
    color: #0a0a0f;
    border: none;
    border-radius: 12px;
    padding: 11px 22px;
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    font-weight: 700;
    cursor: pointer;
    text-decoration: none;
    transition: all 0.2s ease;
    letter-spacing: 0.1px;
    box-shadow: 0 4px 16px rgba(245,197,24,0.25);
  }
  .contact-btn:hover { opacity: 0.88; transform: translateY(-1px); box-shadow: 0 6px 20px rgba(245,197,24,0.35); }
  .contact-btn:active { transform: translateY(0); }
  .contact-btn svg { width: 15px; height: 15px; stroke: #0a0a0f; fill: none; stroke-width: 2.5; stroke-linecap: round; stroke-linejoin: round; }
  .contact-email {
    margin-top: 12px;
    font-size: 11px;
    color: var(--text-muted);
    font-family: 'JetBrains Mono', monospace;
    letter-spacing: 0.3px;
  }

  /* ── Footer ── */
  .page-footer {
    margin: 20px 16px 0;
    text-align: center;
    animation: slideUp 0.5s ease 0.5s both;
  }
  .page-footer-text {
    font-size: 11px;
    color: var(--text-muted);
    line-height: 1.5;
  }
  .page-footer-text a {
    color: var(--text-muted);
    text-decoration: none;
    transition: color 0.2s;
  }
  .page-footer-text a:hover { color: var(--accent); }

  /* ── Animations ── */
  @keyframes slideDown { from { opacity: 0; transform: translateY(-16px); } to { opacity: 1; transform: translateY(0); } }
  @keyframes slideUp { from { opacity: 0; transform: translateY(14px); } to { opacity: 1; transform: translateY(0); } }
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

  /* ── Highlight match ── */
  mark.hl {
    background: transparent;
    color: var(--accent);
    font-weight: 700;
  }

  @media (max-width: 480px) {
    .hero { padding: 20px 12px 16px; }
    .search-wrap { padding: 4px 12px 8px; }
    .section { margin: 10px 12px 0; }
    .contact-section { margin: 14px 12px 0; }
    .page-footer { margin: 16px 12px 0; }
  }
</style>
</head>
<body>

<!-- Nav -->
<nav class="nav">
  <a class="nav-back" href="{% url 'ratemetroapp:settings' %}" aria-label="Back to Settings">
    <svg viewBox="0 0 24 24"><polyline points="15 18 9 12 15 6"/></svg>
  </a>
  <span class="nav-title">Help Center</span>
</nav>

<!-- Page -->
<main class="page">

  <!-- Hero -->
  <div class="hero">
    <div class="hero-icon">
      <svg viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="10"/>
        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
        <line x1="12" y1="17" x2="12.01" y2="17" stroke-width="3"/>
      </svg>
    </div>
    <h1 class="hero-title">How can we help?</h1>
    <p class="hero-sub">Find answers to common questions about rating stations, using the map, and managing your account.</p>
  </div>

  <!-- Search -->
  <div class="search-wrap">
    <div class="search-inner">
      <svg class="search-icon" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
      <input
        type="search"
        class="search-input"
        id="faqSearch"
        placeholder="Search questions…"
        autocomplete="off"
        spellcheck="false"
      >
      <button class="search-clear" id="searchClear" aria-label="Clear search">&times;</button>
    </div>
  </div>

  <!-- FAQ Sections -->
  <div id="faqContainer">

    <!-- Getting Started -->
    <div class="section" data-section>
      <p class="section-label">
        <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16" stroke-width="3"/></svg>
        Getting Started
      </p>
      <div class="section-card">

        <div class="faq-item" data-faq>
          <button class="faq-question" aria-expanded="false">
            <span class="faq-question-text">How do I rate a station?</span>
            <svg class="faq-chevron" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>
          </button>
          <div class="faq-answer-wrap">
            <div class="faq-answer">Tap any station marker on the map to open its details. You'll see a rating panel where you can select safety scores for cleanliness, lighting, crowding, and overall safety. Submit your rating and it will be added to the station's average.</div>
          </div>
        </div>

        <div class="faq-item" data-faq>
          <button class="faq-question" aria-expanded="false">
            <span class="faq-question-text">Do I need an account to rate stations?</span>
            <svg class="faq-chevron" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>
          </button>
          <div class="faq-answer-wrap">
            <div class="faq-answer">Yes, you need to sign in to submit ratings. However, you can browse the map and view existing ratings without an account.</div>
          </div>
        </div>

        <div class="faq-item" data-faq>
          <button class="faq-question" aria-expanded="false">
            <span class="faq-question-text">How do I find a specific station?</span>
            <svg class="faq-chevron" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>
          </button>
          <div class="faq-answer-wrap">
            <div class="faq-answer">Tap the "Stations" pill in the top-left of the map to open the station search panel. You can search by name or filter by metro line.</div>
          </div>
        </div>

      </div>
    </div>

    <!-- Ratings & Reviews -->
    <div class="section" data-section>
      <p class="section-label">
        <svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
        Ratings &amp; Reviews
      </p>
      <div class="section-card">

        <div class="faq-item" data-faq>
          <button class="faq-question" aria-expanded="false">
            <span class="faq-question-text">Can I edit or delete a rating I submitted?</span>
            <svg class="faq-chevron" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>
          </button>
          <div class="faq-answer-wrap">
            <div class="faq-answer">Yes — go to My Ratings (accessible from the menu or your profile). Each rating card has a delete option. At this time, editing requires deleting and resubmitting.</div>
          </div>
        </div>

        <div class="faq-item" data-faq>
          <button class="faq-question" aria-expanded="false">
            <span class="faq-question-text">What does anonymous rating mean?</span>
            <svg class="faq-chevron" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>
          </button>
          <div class="faq-answer-wrap">
            <div class="faq-answer">When anonymous ratings are enabled (in Settings → Privacy), your username is not shown alongside your rating. Your rating still counts toward the station average, but other users cannot see who submitted it.</div>
          </div>
        </div>

        <div class="faq-item" data-faq>
          <button class="faq-question" aria-expanded="false">
            <span class="faq-question-text">How are station scores calculated?</span>
            <svg class="faq-chevron" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>
          </button>
          <div class="faq-answer-wrap">
            <div class="faq-answer">Each station's score is the average of all submitted ratings for that station. Scores cover cleanliness, lighting, crowd levels, and overall safety, each rated 1–5.</div>
          </div>
        </div>

      </div>
    </div>

    <!-- Map & Navigation -->
    <div class="section" data-section>
      <p class="section-label">
        <svg viewBox="0 0 24 24"><polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"/><line x1="8" y1="2" x2="8" y2="18"/><line x1="16" y1="6" x2="16" y2="22"/></svg>
        Map &amp; Navigation
      </p>
      <div class="section-card">

        <div class="faq-item" data-faq>
          <button class="faq-question" aria-expanded="false">
            <span class="faq-question-text">What do the colored markers mean?</span>
            <svg class="faq-chevron" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>
          </button>
          <div class="faq-answer-wrap">
            <div class="faq-answer">Marker colors reflect a station's average safety score — green for high (4–5), yellow for medium (2.5–4), and red for lower scores (below 2.5). Grey markers have no ratings yet.</div>
          </div>
        </div>

        <div class="faq-item" data-faq>
          <button class="faq-question" aria-expanded="false">
            <span class="faq-question-text">How do I use the AI assistant?</span>
            <svg class="faq-chevron" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>
          </button>
          <div class="faq-answer-wrap">
            <div class="faq-answer">Tap the chat bar at the bottom of the map or press the sparkle button to ask Metro Safe AI any question about station safety, recent trends, or specific lines.</div>
          </div>
        </div>

        <div class="faq-item" data-faq>
          <button class="faq-question" aria-expanded="false">
            <span class="faq-question-text">How do I share my location?</span>
            <svg class="faq-chevron" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>
          </button>
          <div class="faq-answer-wrap">
            <div class="faq-answer">Tap the locate button on the map to center on your current position. Your location is only used locally to center the map and is never stored on our servers.</div>
          </div>
        </div>

      </div>
    </div>

    <!-- Account & Privacy -->
    <div class="section" data-section>
      <p class="section-label">
        <svg viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
        Account &amp; Privacy
      </p>
      <div class="section-card">

        <div class="faq-item" data-faq>
          <button class="faq-question" aria-expanded="false">
            <span class="faq-question-text">How do I change my profile picture?</span>
            <svg class="faq-chevron" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>
          </button>
          <div class="faq-answer-wrap">
            <div class="faq-answer">Go to My Profile, tap Edit, then tap your avatar to upload a new photo.</div>
          </div>
        </div>

        <div class="faq-item" data-faq>
          <button class="faq-question" aria-expanded="false">
            <span class="faq-question-text">How do I delete my account?</span>
            <svg class="faq-chevron" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>
          </button>
          <div class="faq-answer-wrap">
            <div class="faq-answer">Go to Settings → Danger Zone and tap "Delete Account." This is permanent and removes all your data including ratings.</div>
          </div>
        </div>

        <div class="faq-item" data-faq>
          <button class="faq-question" aria-expanded="false">
            <span class="faq-question-text">Is my data shared with third parties?</span>
            <svg class="faq-chevron" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>
          </button>
          <div class="faq-answer-wrap">
            <div class="faq-answer">No. We do not sell or share your personal data. Ratings are aggregated anonymously for public display. See our Privacy Policy for full details.</div>
          </div>
        </div>

      </div>
    </div>

    <!-- Troubleshooting -->
    <div class="section" data-section>
      <p class="section-label">
        <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16" stroke-width="3"/></svg>
        Troubleshooting
      </p>
      <div class="section-card">

        <div class="faq-item" data-faq>
          <button class="faq-question" aria-expanded="false">
            <span class="faq-question-text">The map isn't loading. What should I do?</span>
            <svg class="faq-chevron" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>
          </button>
          <div class="faq-answer-wrap">
            <div class="faq-answer">Check your internet connection and refresh the page. If the issue persists, try clearing your browser cache.</div>
          </div>
        </div>

        <div class="faq-item" data-faq>
          <button class="faq-question" aria-expanded="false">
            <span class="faq-question-text">I submitted a rating but it's not showing.</span>
            <svg class="faq-chevron" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>
          </button>
          <div class="faq-answer-wrap">
            <div class="faq-answer">Ratings may take a moment to appear. Pull-to-refresh or reload the page. If still missing after a few minutes, try submitting again.</div>
          </div>
        </div>

        <div class="faq-item" data-faq>
          <button class="faq-question" aria-expanded="false">
            <span class="faq-question-text">The app feels slow on my phone.</span>
            <svg class="faq-chevron" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>
          </button>
          <div class="faq-answer-wrap">
            <div class="faq-answer">Try switching to Light Mode in Settings → Appearance for better performance on older devices.</div>
          </div>
        </div>

      </div>
    </div>

  </div><!-- /faqContainer -->

  <!-- No results -->
  <div class="no-results" id="noResults">
    <span class="no-results-icon">&#128269;</span>
    No questions matched your search.<br>Try different keywords or browse the sections above.
  </div>

  <!-- Contact -->
  <div class="contact-section" id="contactSection">
    <div class="contact-card">
      <div class="contact-icon">
        <svg viewBox="0 0 24 24"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
      </div>
      <h2 class="contact-title">Still need help?</h2>
      <p class="contact-sub">Our team is here for you. Send us a message and we'll get back to you as soon as possible.</p>
      <a class="contact-btn" href="{% url 'ratemetroapp:settings' %}">
        <svg viewBox="0 0 24 24"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
        Send Feedback
      </a>
      <p class="contact-email">support@ratemetro.com</p>
    </div>
  </div>

  <!-- Footer -->
  <div class="page-footer">
    <p class="page-footer-text">
      <a href="{% url 'ratemetroapp:settings' %}">Privacy Policy</a>
      &nbsp;&middot;&nbsp;
      <a href="{% url 'ratemetroapp:settings' %}">Terms of Service</a>
    </p>
  </div>

</main>

<script>
(function () {
  'use strict';

  /* ── Accordion ── */
  var faqItems = document.querySelectorAll('[data-faq]');

  faqItems.forEach(function (item) {
    var btn = item.querySelector('.faq-question');
    var wrap = item.querySelector('.faq-answer-wrap');

    btn.addEventListener('click', function () {
      var isOpen = item.classList.contains('open');

      /* Close all others */
      faqItems.forEach(function (other) {
        if (other !== item && other.classList.contains('open')) {
          other.classList.remove('open');
          other.querySelector('.faq-question').setAttribute('aria-expanded', 'false');
        }
      });

      /* Toggle current */
      if (isOpen) {
        item.classList.remove('open');
        btn.setAttribute('aria-expanded', 'false');
      } else {
        item.classList.add('open');
        btn.setAttribute('aria-expanded', 'true');
      }
    });
  });

  /* ── Search ── */
  var searchInput = document.getElementById('faqSearch');
  var searchClear = document.getElementById('searchClear');
  var noResults = document.getElementById('noResults');
  var contactSection = document.getElementById('contactSection');
  var sections = document.querySelectorAll('[data-section]');

  function escapeRegex(str) {
    return str.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
  }

  function highlight(text, query) {
    if (!query) return text;
    var re = new RegExp('(' + escapeRegex(query) + ')', 'gi');
    return text.replace(re, '<mark class="hl">$1</mark>');
  }

  function doSearch(query) {
    var q = query.trim().toLowerCase();
    var totalVisible = 0;

    sections.forEach(function (section) {
      var items = section.querySelectorAll('[data-faq]');
      var sectionVisible = 0;

      items.forEach(function (item) {
        var questionEl = item.querySelector('.faq-question-text');
        var answerEl = item.querySelector('.faq-answer');

        var questionText = questionEl.getAttribute('data-original') || questionEl.textContent;
        var answerText = answerEl.getAttribute('data-original') || answerEl.textContent;

        /* Store originals */
        if (!questionEl.getAttribute('data-original')) questionEl.setAttribute('data-original', questionText);
        if (!answerEl.getAttribute('data-original')) answerEl.setAttribute('data-original', answerText);

        if (!q) {
          /* Reset */
          questionEl.innerHTML = questionText;
          answerEl.innerHTML = answerText;
          item.style.display = '';
          /* Close all items when clearing search */
          item.classList.remove('open');
          item.querySelector('.faq-question').setAttribute('aria-expanded', 'false');
          sectionVisible++;
          return;
        }

        var qLower = questionText.toLowerCase();
        var aLower = answerText.toLowerCase();
        var matches = qLower.includes(q) || aLower.includes(q);

        if (matches) {
          item.style.display = '';
          item.classList.add('open');
          item.querySelector('.faq-question').setAttribute('aria-expanded', 'true');
          questionEl.innerHTML = highlight(questionText, q);
          answerEl.innerHTML = highlight(answerText, q);
          sectionVisible++;
          totalVisible++;
        } else {
          item.style.display = 'none';
          item.classList.remove('open');
          item.querySelector('.faq-question').setAttribute('aria-expanded', 'false');
        }
      });

      /* Hide entire section if no items match */
      section.style.display = sectionVisible === 0 && q ? 'none' : '';
      if (!q) totalVisible += sectionVisible;
    });

    /* No-results state */
    if (q && totalVisible === 0) {
      noResults.classList.add('visible');
      contactSection.style.display = 'none';
    } else {
      noResults.classList.remove('visible');
      contactSection.style.display = '';
    }

    /* Clear button */
    if (q) {
      searchClear.classList.add('visible');
    } else {
      searchClear.classList.remove('visible');
    }
  }

  searchInput.addEventListener('input', function () {
    doSearch(this.value);
  });

  searchClear.addEventListener('click', function () {
    searchInput.value = '';
    searchInput.focus();
    doSearch('');
  });

  /* Clear the browser's native search cancel button side effects */
  searchInput.addEventListener('search', function () {
    doSearch(this.value);
  });

})();
</script>

</body>
</html>
